<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html"><link rel="search" title="Search" href="search.html"><link rel="next" title="Examples" href="examples.html"><link rel="prev" title="ASTrIX" href="index.html">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>ASTrIX: AeroSpace Trajectory Imaging toolboX - AsTrIX documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">AsTrIX  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <span class="sidebar-brand-text">AsTrIX  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Getting Started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="examples.html">Examples</a><input aria-label="Toggle navigation of Examples" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/example_1.html">Example 1 placeholder</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="api/index.html">API Reference</a><input aria-label="Toggle navigation of API Reference" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="api/astrix.time.html">astrix.time module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/astrix.spatial.location.html">astrix.spatial.location module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/astrix.spatial.frame.html">astrix.spatial.frame module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/astrix.spatial.ray.html">astrix.spatial.ray module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/astrix.spatial.rotation.html">astrix.spatial.rotation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/astrix.project.html">astrix.project module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/astrix.generic.html">astrix.generic module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/astrix.planning.html">astrix.planning module</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/getting_started.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="astrix-aerospace-trajectory-imaging-toolbox">
<h1>ASTrIX: AeroSpace Trajectory Imaging toolboX<a class="headerlink" href="#astrix-aerospace-trajectory-imaging-toolbox" title="Link to this heading">¶</a></h1>
<p><em>Under Construction…</em></p>
<p>A Python tool package for planning and analysing aerospace imaging campaigns.</p>
<p><a class="reference external" href="https://github.com/andrewjlock/astrix/actions/workflows/tests.yml"><img alt="Tests" src="https://github.com/andrewjlock/astrix/actions/workflows/tests.yml/badge.svg" /></a> <a class="reference external" href="https://github.com/andrewjlock/astrix/actions/workflows/docs.yml"><img alt="Documentation" src="https://github.com/andrewjlock/astrix/actions/workflows/docs.yml/badge.svg" /></a>
<a class="reference external" href="https://codecov.io/github/andrewjlock/astrix"><img alt="codecov" src="https://codecov.io/github/andrewjlock/astrix/graph/badge.svg?token=N781FLJEI5" /></a></p>
<p><a class="reference external" href="https://andrewjlock.github.io/astrix/">View the full documentation here</a>.
Source code is hosted on <a class="reference external" href="https://github.com/andrewjlock/astrix">GitHub</a>.</p>
<section id="features">
<h2>Features<a class="headerlink" href="#features" title="Link to this heading">¶</a></h2>
<ul>
<li><p>Simple, object-oriented interface to reconstruct simultaneous moving and rotating reference frames, calculate local line-of-sight vectors, and project to image planes.</p></li>
<li><p>Many convenience tools for interpolation, intrinsic frame handling, triangulation, position conversion, data validation etc.</p></li>
<li><p>Support for NumPy and Jax backends using the <a class="reference external" href="https://data-apis.org/array-api/latest/">array api</a> spec. Most functionality is differentiable and JIT-compilable using Jax backend, allowing efficient optimisation and state estimation.</p></li>
</ul>
<p>This toolbox has three main use cases:</p>
<ol class="arabic">
<li><p>Planning flight paths and ground station placement for aerospace observation campaigns.</p></li>
<li><p>Trajectory reconstruction and state estimation from observational data (e.g. optical tracking).</p></li>
<li><p>Aiding analysis of scientific optical measurements (e.g. spectral data).</p></li>
</ol>
</section>
<section id="install">
<h2>Install<a class="headerlink" href="#install" title="Link to this heading">¶</a></h2>
<p>The repository is not yet published to PyPI, so installation is via cloning the repository and installing using pip.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/andrewjlock/astrix.git
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>astrix
</pre></div>
</div>
<p>While under development editable installation is recommend</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.<span class="o">[</span>plot,jax<span class="o">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">plot</span></code> extra install <a class="reference external" href="https://matplotlib.org/basemap/">basemap</a> and <a class="reference external" href="https://scitools.org.uk/cartopy/docs/latest/">cartopy</a> for geographic plotting.
The <code class="docutils literal notranslate"><span class="pre">jax</span></code> extra installs <a class="reference external" href="https://github.com/jax-ml/jax">Jax</a> which is used for optional advanced automatic differentiation and state/parameter estimation capabilities.
For a lean install you can omit both the <code class="docutils literal notranslate"><span class="pre">[jax]</span></code> and <code class="docutils literal notranslate"><span class="pre">[plot]</span></code> extra,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.
</pre></div>
</div>
<p>For development, use the <code class="docutils literal notranslate"><span class="pre">dev</span></code> and <code class="docutils literal notranslate"><span class="pre">docs</span></code> groups, which includes linting, testing, document generation, as well as plotting and jax extras,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.<span class="o">[</span>plot<span class="o">]</span><span class="w"> </span>--group<span class="w"> </span>dev<span class="w"> </span>--group<span class="w"> </span>docs
</pre></div>
</div>
<p>Alternatively, this project has been developed with, and is compliant with, the <code class="docutils literal notranslate"><span class="pre">uv</span></code> package manager.
The <code class="docutils literal notranslate"><span class="pre">dev</span></code> and <code class="docutils literal notranslate"><span class="pre">docs</span></code> groups are installed by default.</p>
<p>To develop using <code class="docutils literal notranslate"><span class="pre">uv</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/andrewjlock/astrix.git
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>astrix
$<span class="w"> </span>uv<span class="w"> </span>python<span class="w"> </span>install<span class="w"> </span><span class="m">3</span>.12
$<span class="w"> </span>uv<span class="w"> </span>sync
$<span class="w"> </span>uv<span class="w"> </span>run<span class="w"> </span>pytest<span class="w"> </span>tests/<span class="w"> </span><span class="c1"># to run tests</span>
</pre></div>
</div>
<p>To use in another <code class="docutils literal notranslate"><span class="pre">uv</span></code> project (from a local install):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>../path/to/your/other/uv/project
$<span class="w"> </span>uv<span class="w"> </span>add<span class="w"> </span>--editable<span class="w"> </span>../path/to/astrix<span class="o">[</span>plot<span class="o">]</span><span class="w"> </span><span class="c1"># or extras as needed</span>
</pre></div>
</div>
<section id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading">¶</a></h3>
<p>You will need to manually install the following dependency using apt</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>libgeos-dev
</pre></div>
</div>
<p>The package is currently tested with Python 3.12 (default on Ubuntu 24.04 LTS).
Such a recent version of Python is required to support the recent array API spec features enabling <a class="reference internal" href="#backend-compatibility---numpy-and-jax"><span class="xref myst">backend switching</span></a>.</p>
</section>
</section>
<section id="data-conventions">
<h2>Data Conventions<a class="headerlink" href="#data-conventions" title="Link to this heading">¶</a></h2>
<p>The following conventions are used data representation throughout the package:</p>
<ul>
<li><p>Time series data is represented as 2D arrays of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">D)</span></code>, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of time steps and <code class="docutils literal notranslate"><span class="pre">D</span></code> is the dimensionality of the vector (e.g., 3 for 3D position).</p></li>
<li><p>Single vectors are represented as 1D arrays of shape <code class="docutils literal notranslate"><span class="pre">(D,)</span></code>.</p></li>
<li><p>By default, position is stored as Cartesian ECEF coordinates represented as <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y,</span> <span class="pre">z)</span></code> in metres.</p></li>
<li><p>Geodetic coordinates are represented as <code class="docutils literal notranslate"><span class="pre">(latitude,</span> <span class="pre">longitude,</span> <span class="pre">altitude)</span></code>, where latitude and longitude are in degrees and altitude is in metres.</p></li>
</ul>
<p>In addition, all classes in the package are designed to be immutable (for Jax compatibiliy).
Any method which modifies the state of an object will return a new instance of the object with the modified state (although child objects, such as arrays, may be shared, depending on the operation).</p>
</section>
<section id="backend-compatibility-numpy-and-jax">
<h2>Backend Compatibility - NumPy and Jax<a class="headerlink" href="#backend-compatibility-numpy-and-jax" title="Link to this heading">¶</a></h2>
<p><em>Note: This section is only relevant for those wishing to do efficient optimisation or state estimation</em></p>
<p>This project uses the <a class="reference external" href="https://data-apis.org/array-api/">Array API</a> standard to enable switching between NumPy and <a class="reference external" href="https://jax.readthedocs.io/en/latest/">Jax</a> backends for most core classes and functions, using their common native API.
NumPy is the default, and superior for most use cases.
Jax provides two extra capabilities: automatic differentiation and JIT compilation, which can be useful for batch processing and optimisation problems.
If Jax is of no interest to you, you can safely ignore backend arguments altogether.</p>
<p>Classes and functions which support both backends have a constructor <code class="docutils literal notranslate"><span class="pre">backend</span></code> argument, which can be set to either <code class="docutils literal notranslate"><span class="pre">'numpy'</span></code>/<code class="docutils literal notranslate"><span class="pre">'np'</span></code> or <code class="docutils literal notranslate"><span class="pre">'jax'</span></code>/<code class="docutils literal notranslate"><span class="pre">'jnp'</span></code>, or a reference to either namespace.
Moreover, classes also have a <code class="docutils literal notranslate"><span class="pre">.convert_to(&quot;desired_backend&quot;)</span></code> method to convert between backends.
This conversion is recursive, and will also convert all required child objects.
The suggested use case is therefore to create a model in NumPy, and then convery only the relevant objects to Jax when needed for JIT compilation or differentiation.
Functions/methods that have no anticipated need for Jax capabilities are implemented in NumPy only, as are those that have Jax incompatible dependencies (for example, accurate conversion between ECEF and geodetic coordinates which uses the <a class="reference external" href="https://github.com/pyproj4/pyproj"><code class="docutils literal notranslate"><span class="pre">pyproj</span></code></a> package).
Users will be alerted to attempts to use Jax backend in such cases with warnings or errors.</p>
<p>Although effort has been made to ensure any two interacting objects use similar or compatible backends, this is not guaranteed.
The primary CI workflows test NumPy backends only.</p>
<p>To use the Jax backend, you will need to ensure the SciPy environment environment variable is set, via Python before you import <code class="docutils literal notranslate"><span class="pre">scipy.spatial.transform.Rotation</span></code>. This is done automatically when you import <code class="docutils literal notranslate"><span class="pre">astrix</span></code>, but can also be done manually:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;SCIPY_ARRAY_API&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;True&quot;</span>
</pre></div>
</div>
<p>or in your shell</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">SCIPY_ARRAY_API</span><span class="o">=</span>True
</pre></div>
</div>
<p>Failure to set this environment variable will result in errors using the SciPy Rotation module with Jax backend.</p>
<p>Note that Jax backend is implemented on CPU only, and 64-bit precision is enforced on <code class="docutils literal notranslate"><span class="pre">astrix</span></code> import (Jax defaults to 32-bit, which often is insufficient for large ECEF values).
However, if you import <code class="docutils literal notranslate"><span class="pre">jax</span></code> manually before <code class="docutils literal notranslate"><span class="pre">astrix</span></code>, these environment variables can be manually set in your shell:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">JAX_ENABLE_X64</span><span class="o">=</span>True
$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">JAX_PLATFORM_NAME</span><span class="o">=</span>cpu
</pre></div>
</div>
<p>or in the header of your Python script:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;JAX_ENABLE_X64&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;JAX_PLATFORMS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span>
</pre></div>
</div>
</section>
<section id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Link to this heading">¶</a></h2>
<p>Contributions are very welcome! Please submit proposed changes via pull requests on GitHub.</p>
</section>
<section id="tests">
<h2>Tests<a class="headerlink" href="#tests" title="Link to this heading">¶</a></h2>
<p>Tests are implemented using pytest. To run the tests:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pytest<span class="w"> </span>tests/
</pre></div>
</div>
<p>or using <code class="docutils literal notranslate"><span class="pre">uv</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>uv<span class="w"> </span>run<span class="w"> </span>pytest<span class="w"> </span>tests/
</pre></div>
</div>
<p>If Jax is installed, tests will be run using both NumPy and Jax backends.
If Jax is not installed, only NumPy backend tests will be run.</p>
</section>
<section id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Link to this heading">¶</a></h2>
<p>Documentation is generated using Sphinx. To build the documentation:</p>
<ol class="arabic">
<li><p>Install dependencies: <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">docs/requirements.txt</span></code></p></li>
<li><p>Navigate to the docs directory: <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">docs</span></code></p></li>
<li><p>Run the generate script <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">generate_docs.py</span></code></p></li>
<li><p>Build the docs: <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html</span></code>
Or, to live view the docs while editing:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sphinx-autobuild<span class="w"> </span>.<span class="w"> </span>_build/html/
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="examples.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Examples</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Andrew Lock
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">ASTrIX: AeroSpace Trajectory Imaging toolboX</a><ul>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#install">Install</a><ul>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-conventions">Data Conventions</a></li>
<li><a class="reference internal" href="#backend-compatibility-numpy-and-jax">Backend Compatibility - NumPy and Jax</a></li>
<li><a class="reference internal" href="#contributing">Contributing</a></li>
<li><a class="reference internal" href="#tests">Tests</a></li>
<li><a class="reference internal" href="#documentation">Documentation</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=8a448e45"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>